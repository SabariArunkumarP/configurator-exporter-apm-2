{"tags": {"projectName": "tda-poc", "Name": "test", "appName": "testplugin"}, "enabled": true, "targets": [{"index": "tdapoc-logger", "protocol": "http", "name": "log-apm", "host": "10.11.100.208", "store_type": "logger", "type": "elasticsearch", "port": "9200"}, {"index": "tdapoc-metric", "protocol": "http", "name": "metric-apm", "host": "10.11.100.208", "store_type": "metric", "type": "elasticsearch", "port": "9200"}], "plugins": [{"usr_filter": {}, "name": "linux-syslog", "transform": {"node": "#{Socket.gethostname}", "_plugin": "linux", "ident": "${record['ident']}", "level": "${n_level='info'; if record.key?('level') == nil or record['level'] == nil then n_level else record['level'].strip() end}", "pid": "${record['pid']}", "_documentType": "syslog", "host": "${record['host']}", "file": "${tag_suffix[2]}", "time": "${require 'time'; time.to_time.to_i}"}, "parse": {"extra_data": {"expressions": ["(?<time>[^ ]*\\s*[^ ]* [^ ]*) (?<host>[^ ]*) (?<ident>[^:\\[]*)(?:\\[(?<pid>[0-9]+)\\])?(?:[^\\:]*\\:)? \\[(?<level>[^\\]][\\A-z]+)\\] (?<message>.+)", "(?<time>[^ ]*\\s*[^ ]* [^ ]*) (?<host>[^ ]*) (?<ident>[^:\\[]*)(?:\\[(?<pid>[0-9]+)\\])?(?:[^\\:]*\\:)? (?<level>(error)|(warning))\\: (?<message>.*)", "(?<time>[^ ]*\\s*[^ ]* [^ ]*) (?<host>[^ ]*) (?<ident>[^:\\[]*)(?:\\[(?<pid>[0-9]+)\\])?(?:[^\\:]*\\:)? (?<message>.*)"], "@type": "multi_format"}}, "source": {"path": "/var/log/syslog, /var/log/auth.log, /var/log/messages, /var/log/secure", "pos_file": "/var/log/td-agent/syslog.pos", "tag": {}, "@type": "tail"}, "collection_type": "", "rewrite_tag_filter": {"clear": "(?<time>[^ ]*\\s*[^ ]* [^ ]*) (?<host>[^ ]*) (?<ident>(collectd)|(python))", "extra_data": "(?<time>[^ ]*\\s*[^ ]* [^ ]*) (?<host>[^ ]*) (?<ident>.*)"}, "match": {"flush_interval": "30s"}}]}